## kafka有多处选举
控制器选举
partition选主
消费者组选主

## 控制器选举
当kafka集群中有一个或者多个的broker存在的时候，就会有一个broker当选为控制器
控制器选举巧妙地利用了zookeeper的临时节点。
多个broker会尝试在zookeeper上创建一个/controller的临时节点，创建成功的broker就成为控制器
控制器会关注不同的partition的状态，并负责状态异常的partition主从的选主。
这里的关注，依然是巧妙地利用了zookeeper地临时节点机制。
每一个partition都会在zookeeper上注册一个临时节点，然后控制器会watch这个节点
当partition宕机的时候，控制器感知到，就会同步这个信息给其他的broker

## partition 选主
partition的选主是由控制器完成的。
只有位于ISR中的replica才有可能当选为新的leader。
控制器会根据配置的策略对partition完成选主

## 消费者组选主
消费者组也会选出一个leader，选举过程基本就是随机，不细说了。
