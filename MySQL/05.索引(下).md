>通过索引优化避免回表过程

## 覆盖索引
查询满足2个条件
1. 要查询的内容在某棵非主键索引树内
2. 查询的过程要用到这个索引树

例子：假设有一棵联合索引树(a, b)
1. 属于覆盖索引
```sql
select b from T where a = 2;
```
2. 虽然要查找的信息在这棵索引树中，但是查询过程不经过这棵树，因此不是覆盖索引
```sql
select a, b from T where c = 3;
```

## 前缀索引
#### 最左前缀原则
联合索引(a, b)先按a排序，再按b排序，此时这个联合索引可当做两个索引a、(a, b)来用，不必再建立一个a的单列索引。  
但是如果要按单列b来进行查询的话则需要建立b单列索引。

最左前缀用于在索引中定位记录。

#### 建立联合索引时，如何安排字段内的索引顺序
考虑两个因素：

1. 尽量少建一个单列索引。
>如果查询时常用的列是(a)，则建立(a, b)就可避免再建立一个(a)的单列索引

2. 减少空间占用。
>如果要建立一个联合索引(name, age)，由于name占用的空间更大，因此建立(name, age)的双列索引和(age)的单列索引更节省空间。

## 索引下推
以市民表的联合索引（name, age）为例。如果现在有一个需求：检索出表中“名字第一个字是张，而且年龄是10岁的所有男孩”。那么，SQL语句是这么写的：
```sql
mysql> select * from tuser where name like '张%' and age=10 and ismale=1;
```
1. 无索引下推的情况
从联合索引（name, age）中找到第一个姓张的记录，然后直接回表查看那行记录是否满足剩下的条件，接着在联合索引中往后遍历，找下一个姓张的记录，以此类推。

2. 有索引下推的情况
从联合索引（name, age）中找到第一个姓张的记录，然后检查是否满足age=10，如果不是，接着遍历下一个，对所有满足age=10的记录进行回表操作，然后再检查ismale是否1，如果是，就放入结果集。直至联合索引中的下一个记录不满足姓张的条件，就返回最终结果集。
